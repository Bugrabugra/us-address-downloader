{"version":3,"sources":["../../electron/preload/index.ts"],"sourcesContent":["import { contextBridge, ipcRenderer } from \"electron\";\nimport { ElectronApi } from \"../types\";\n\nfunction domReady(\n  condition: DocumentReadyState[] = [\"complete\", \"interactive\"]\n) {\n  return new Promise((resolve) => {\n    if (condition.includes(document.readyState)) {\n      resolve(true);\n    } else {\n      document.addEventListener(\"readystatechange\", () => {\n        if (condition.includes(document.readyState)) {\n          resolve(true);\n        }\n      });\n    }\n  });\n}\n\nconst safeDOM = {\n  append(parent: HTMLElement, child: HTMLElement) {\n    if (\n      !Array.from(parent.children).find((e) => {\n        return e === child;\n      })\n    ) {\n      return parent.appendChild(child);\n    }\n  },\n  remove(parent: HTMLElement, child: HTMLElement) {\n    if (\n      Array.from(parent.children).find((e) => {\n        return e === child;\n      })\n    ) {\n      return parent.removeChild(child);\n    }\n  }\n};\n\n/**\n * https://tobiasahlin.com/spinkit\n * https://connoratherton.com/loaders\n * https://projects.lukehaas.me/css-loaders\n * https://matejkustec.github.io/SpinThatShit\n */\nfunction useLoading() {\n  const className = `loaders-css__square-spin`;\n  const styleContent = `\n@keyframes square-spin {\n  25% { transform: perspective(100px) rotateX(180deg) rotateY(0); }\n  50% { transform: perspective(100px) rotateX(180deg) rotateY(180deg); }\n  75% { transform: perspective(100px) rotateX(0) rotateY(180deg); }\n  100% { transform: perspective(100px) rotateX(0) rotateY(0); }\n}\n.${className} > div {\n  animation-fill-mode: both;\n  width: 50px;\n  height: 50px;\n  background: #fff;\n  animation: square-spin 3s 0s cubic-bezier(0.09, 0.57, 0.49, 0.9) infinite;\n}\n.app-loading-wrap {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: #282c34;\n  z-index: 9;\n}\n    `;\n  const oStyle = document.createElement(\"style\");\n  const oDiv = document.createElement(\"div\");\n\n  oStyle.id = \"app-loading-style\";\n  oStyle.innerHTML = styleContent;\n  oDiv.className = \"app-loading-wrap\";\n  oDiv.innerHTML = `<div class=\"${className}\"><div></div></div>`;\n\n  return {\n    appendLoading() {\n      safeDOM.append(document.head, oStyle);\n      safeDOM.append(document.body, oDiv);\n    },\n    removeLoading() {\n      safeDOM.remove(document.head, oStyle);\n      safeDOM.remove(document.body, oDiv);\n    }\n  };\n}\n\n// ----------------------------------------------------------------------\n\nconst { appendLoading, removeLoading } = useLoading();\ndomReady().then(appendLoading);\n\nwindow.onmessage = (ev) => {\n  ev.data.payload === \"removeLoading\" && removeLoading();\n};\n\nsetTimeout(removeLoading, 1000);\n\nconst api: ElectronApi = {\n  getItems: ({ pathName, regex }) => {\n    return ipcRenderer.invoke(\"get-items\", pathName, regex);\n  },\n  openSettingsMenu: (callback) => {\n    return ipcRenderer.on(\"open-settings-menu\", callback);\n  },\n  setToStore: (object) => {\n    return ipcRenderer.send(\"set-to-store\", object);\n  },\n  getFromStore: () => {\n    return ipcRenderer.invoke(\"get-from-store\");\n  },\n  selectFolder: () => {\n    return ipcRenderer.invoke(\"select-folder\");\n  },\n  testDbConnection: ({ dbValues }) => {\n    return ipcRenderer.invoke(\"test-db-connection\", dbValues);\n  }\n};\n\ncontextBridge.exposeInMainWorld(\"electronApi\", api);\n"],"mappings":"AAAA,sBAA2C;AAG3C,SAAS,SACP,YAAkC,CAAC,YAAY,aAAa,GAC5D;AACA,SAAO,IAAI,QAAQ,CAAC,YAAY;AAC9B,QAAI,UAAU,SAAS,SAAS,UAAU,GAAG;AAC3C,cAAQ,IAAI;AAAA,IACd,OAAO;AACL,eAAS,iBAAiB,oBAAoB,MAAM;AAClD,YAAI,UAAU,SAAS,SAAS,UAAU,GAAG;AAC3C,kBAAQ,IAAI;AAAA,QACd;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF,CAAC;AACH;AAEA,MAAM,UAAU;AAAA,EACd,OAAO,QAAqB,OAAoB;AAC9C,QACE,CAAC,MAAM,KAAK,OAAO,QAAQ,EAAE,KAAK,CAAC,MAAM;AACvC,aAAO,MAAM;AAAA,IACf,CAAC,GACD;AACA,aAAO,OAAO,YAAY,KAAK;AAAA,IACjC;AAAA,EACF;AAAA,EACA,OAAO,QAAqB,OAAoB;AAC9C,QACE,MAAM,KAAK,OAAO,QAAQ,EAAE,KAAK,CAAC,MAAM;AACtC,aAAO,MAAM;AAAA,IACf,CAAC,GACD;AACA,aAAO,OAAO,YAAY,KAAK;AAAA,IACjC;AAAA,EACF;AACF;AAQA,SAAS,aAAa;AACpB,QAAM,YAAY;AAClB,QAAM,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAOpB,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAoBV,QAAM,SAAS,SAAS,cAAc,OAAO;AAC7C,QAAM,OAAO,SAAS,cAAc,KAAK;AAEzC,SAAO,KAAK;AACZ,SAAO,YAAY;AACnB,OAAK,YAAY;AACjB,OAAK,YAAY,eAAe,SAAS;AAEzC,SAAO;AAAA,IACL,gBAAgB;AACd,cAAQ,OAAO,SAAS,MAAM,MAAM;AACpC,cAAQ,OAAO,SAAS,MAAM,IAAI;AAAA,IACpC;AAAA,IACA,gBAAgB;AACd,cAAQ,OAAO,SAAS,MAAM,MAAM;AACpC,cAAQ,OAAO,SAAS,MAAM,IAAI;AAAA,IACpC;AAAA,EACF;AACF;AAIA,MAAM,EAAE,eAAe,cAAc,IAAI,WAAW;AACpD,SAAS,EAAE,KAAK,aAAa;AAE7B,OAAO,YAAY,CAAC,OAAO;AACzB,KAAG,KAAK,YAAY,mBAAmB,cAAc;AACvD;AAEA,WAAW,eAAe,GAAI;AAE9B,MAAM,MAAmB;AAAA,EACvB,UAAU,CAAC,EAAE,UAAU,MAAM,MAAM;AACjC,WAAO,4BAAY,OAAO,aAAa,UAAU,KAAK;AAAA,EACxD;AAAA,EACA,kBAAkB,CAAC,aAAa;AAC9B,WAAO,4BAAY,GAAG,sBAAsB,QAAQ;AAAA,EACtD;AAAA,EACA,YAAY,CAAC,WAAW;AACtB,WAAO,4BAAY,KAAK,gBAAgB,MAAM;AAAA,EAChD;AAAA,EACA,cAAc,MAAM;AAClB,WAAO,4BAAY,OAAO,gBAAgB;AAAA,EAC5C;AAAA,EACA,cAAc,MAAM;AAClB,WAAO,4BAAY,OAAO,eAAe;AAAA,EAC3C;AAAA,EACA,kBAAkB,CAAC,EAAE,SAAS,MAAM;AAClC,WAAO,4BAAY,OAAO,sBAAsB,QAAQ;AAAA,EAC1D;AACF;AAEA,8BAAc,kBAAkB,eAAe,GAAG;","names":[],"file":"index.js"}